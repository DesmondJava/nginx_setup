{% load staticfiles %}
{% extends 'base.html' %}

{% block content %}

<div class="container">
    <h2 class="text-center">{{ question.title }}</h2>
    <hr>
    <br>
    <p>{{ question.text }}</p>
    <br>
    <button href="#" data-toggle="tooltip" title="Increase rating of this question" class="btn btn-primary btn-xs">+1</button>
    <button href="#" data-toggle="tooltip" title="Decrease rating of this question" class="btn btn-primary btn-xs">-1</button>
<script src = "{% static 'js/jquery.min.js' %}"></script>
     <script>
                    if (typeof jQuery != 'undefined') {

    alert("jQuery library is loaded!");

}else{

    alert("jQuery library is not found!");

}
                    </script>



    <script>

        $(function(){
            $('#tst').on('submit', function(e){
                e.preventDefault();
                $.ajax({
                    url: '/rating/', //this is the submit URL
                    type: 'POST', //or POST
                    data: {
                        question_123: "{{ question.id }}",
                        changing: 'plus' }
                        })
                     .success(function(data) {
                         if (data.status == 'ok') {
                             console.log(data.comment_id);
                        }
                        }).error(function() {
                            console.log('http error')
                        });
        });
    });


    $.ajax({
        url: '/rating/',
        type: 'POST',
        data: { question_123: "{{ question.id }}", changing: 'plus' }
    }).success(function(data) {
        if (data.status == 'ok') {
            console.log(data.comment_id);
        }
    }).error(function() {
        console.log('http error')
    });
    </script>

{#<form method="post" action="/rating/">#}
<form id="tst">
        {% csrf_token %}
{#            <input type="hidden" name="changing" value="plus" />#}
{#            <input type="hidden" name="question_123" value="{{ question.id }}" />#}
    <input class="btn btn-success btn-sm" type="submit" value="Submit" />
        </form>

















    <p class="text-right">
        <strong>Author:</strong> {{ question.author }} <br>
        <strong>Published at:</strong> {{ question.added_at|date:'Y-m-d H:i' }}
    </p>
<br>
<hr>

    {% if answers %}
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Answers:</th>
                </tr>
            </thead>
            <tbody>
                {% for answer in answers %}
                    <tr>
                        <td class="col-md-8"><p>{{ answer }}</p></td>
                        <td class="col-md-3 text-center"><p>{{ answer.added_at|date:'Y-m-d H:i' }}</p></td>
                        <td class="col-md-2 text-center"><p>{{ answer.author }}</p></td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% endif %}

    <h3>Your could write your answer:</h3>
    <div class="panel-body">
        <form method="post" action="/answer/{{ question.id }}/">
        {% csrf_token %}
            <p class="bs-component">
                <table>
                    <tr>
                        <td>{{ form.text }}</td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            {% if form.text.errors %}
                                 {{ form.text.errors }}
                            {% endif %}
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <p class="bs-component">
                                <div style="text-align: center;">
                                    <input class="btn btn-success btn-sm" type="submit" value="Submit" />
                                </div>
                            </p>
                        </td>
                    </tr>
                </table>
            </p>
            <input type="hidden" name="question" value="{{ question.id }}" />
        </form>
    </div>
</div>
{% endblock %}